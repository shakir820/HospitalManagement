
<h4 class="m-3">Patient Details</h4>


<div class="row m-md-3">
  <div class="col-sm-12 py-2 col-md-6">
    <div class="card h-100 shadow">
      <div class="card-body font-weight-bold">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <div class="align-self-center" style="width: 150px; height: 150px;">
              <app-profile-pic-preview [user_id]="patient_id"></app-profile-pic-preview>
            </div>

            <h3 class="mt-3 font-weight-bold text-dark">{{patient.name}}</h3>
            <div class="d-flex">
              <div>Id: </div>
              <div class="text-primary ml-2">{{patient.id}}</div>
            </div>

            <!-- <div>{{patient.username}}</div> -->
            <!-- <div class="mt-3">
              <button class="btn btn-sm btn-primary rounded-pill px-4">Prescribe Medicines</button>
            </div> -->
          </div>
          <div class="col-sm-12 col-md-6" *ngIf="upcoming_appointment">
            <div class="mt-md-0 mt-3 border-bottom-light">
              <h6>Upcoming Appointment</h6>
            </div>
            <div class="d-flex flex-column align-items-sm-start">
              <div class="font-weight-bold text-primary">{{upcoming_appointment.appointment_date | date: 'mediumDate'}}</div>
              <div class="small">{{upcoming_appointment.start_time | date: 'shortTime'}} - {{upcoming_appointment.end_time | date: 'shortTime'}}</div>
            </div>
            <div class="d-flex">
              <div>Visiting price: </div>
              <div class="ml-2">{{upcoming_appointment.visiting_price}}TK.</div>
            </div>
            <div class="mt-4">
              <button *ngIf="upcoming_appointment.consulted != true" (click)="onCreatePrescriptionClicked($event)"
                      class="btn btn-sm btn-primary rounded-pill px-4">
                Create Prescription
              </button>
              <button *ngIf="upcoming_appointment.consulted" (click)="onUpComingAppointmentViewPrescriptionClicked($event)" class="btn btn-sm btn-primary rounded-pill px-4">View Prescription</button>
            </div>
          </div>



        </div>
      </div>
    </div>
  </div>



  <div class="col-sm-12 py-2 col-md-6">
    <div class="card h-100 shadow">
      <div class="font-weight-bold card-header">
        Details
      </div>
      <div class="card-body font-weight-bold">
        <div class="row">
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Gender</div>
              <div class="text-dark">{{patient.gender}}</div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Age</div>
              <div class="text-dark">{{patient.age}}</div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Blood Group</div>
              <div class="text-dark">{{patient.bloodGroup}}</div>
            </div>
          </div>

        </div>

        <div class="row mt-4">
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Phone Number</div>
              <div class="text-dark">{{patient.phoneNumber}}</div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Email</div>
              <div class="text-dark">{{patient.email}}</div>
            </div>
          </div>
        </div>


        <div class="row mt-4">

          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Country</div>
              <div class="text-dark">{{patient.country_name}}</div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">City</div>
              <div class="text-dark">{{patient.city_name}}</div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">State</div>
              <div class="text-dark">{{patient.state_name}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>





  <div class="col-sm-12 py-2 col-md-6" *ngIf="appointmentList && appointmentList.length > 0">
    <div class="card h-100 shadow">
      <div class=" card-header">
        <div class="font-weight-bold">
          Past Appointments <span class="ml-3 text-success">{{ appointmentList.length }}</span>
        </div>
      </div>
      <div class="card-body font-weight-bold">
        <div class="row" *ngFor="let item of appointmentList">
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="font-weight-bold text-primary">{{item.appointment_date | date: 'mediumDate'}}</div>
              <div class="small">{{item.start_time | date: 'shortTime'}} - {{item.end_time | date: 'shortTime'}}</div>
            </div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-4">
            <div class="border-bottom-light d-flex flex-column align-items-sm-start">
              <div class="small">Doctor</div>
              <div class="text-dark">{{item.doctor_name}}</div>
            </div>
          </div>
          <div class="col-sm-12  col-md-6 col-lg-4">
            <div class=" d-flex justify-content-md-center align-items-center h-100">
              <button class="btn btn-sm btn-outline-primary" (click)="pastAppointmentViewPrescription($event, item.id)">View Prescription</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>








  <div class="col-sm-12 py-2 col-md-6">
    <div class="card h-100 shadow">
      <div class=" card-header">
        <div class="font-weight-bold">
          Investigation
        </div>
      </div>
      <div class="card-body font-weight-bold">

        <div class="accordion" *ngIf="investigationGroupList.length > 0" id="accordionExample">
          <div class="card" *ngFor="let item of investigationGroupList; index as i">
            <div class="card-header" [id]="'heading' + i">
              <h2 class="mb-0">
                <button class="btn btn-block btn-link text-left" type="button" data-toggle="collapse" [attr.data-target]="'#collapseOne' + i"
                        aria-expanded="true" [attr.aria-controls]="'collapseOne' + i">
                  <div class="font-weight-bold">{{item.group_name}}</div>
                </button>
              </h2>
            </div>

            <div [id]="'collapseOne' + i" class="collapse" [aria-labelledby]="'heading' + i" data-parent="#accordionExample">
              <div class="card-body">
                <div class="row" [ngClass]="{'bg-gray-100': evenItem == true}" *ngFor="let inv_item of investigationGroupList[i].investigations; even as evenItem">
                  <div class="col-sm-6">
                    <div class="d-flex">
                      <div>
                        <a class="text-dark" target="_blank" [href]="inv_item.file_link">{{inv_item.name}}</a>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6">
                    <div class="d-flex">
                      <div class="small">{{inv_item.created_date | date: 'mediumDate'}}</div>
                    </div>
                  </div>
                  <!-- <div class="col-sm-12 col-md-6 col-lg-4">
                    <div class="border-bottom-light d-flex flex-column align-items-sm-start">
                      <div class="small">Prescribed by</div>
                    </div>
                  </div> -->
                </div>
              </div>
            </div>
          </div>
        </div>


        <div *ngIf="investigationGroupList.length == 0" class=" d-flex flex-column justify-content-between align-items-center">
          <div><i class="fad fa-3x fa-vial"></i></div>
          <div class="mt-3 font-weight-bold">The user has no Investigation File</div>
        </div>


      </div>
    </div>
  </div>




  <div class="cols-m-12 py-2 col-md-6">
    <div class=" card shadow border-0">
      <div class=" card-header">
        <div class="font-weight-bold">Document List</div>
      </div>
      <div class="card-body ">
        <table *ngIf="document_list.length > 0 && !fetchingDocument" class="table table-striped table-borderless table-responsive-lg text-dark">
          <thead>
            <tr>
              <th scope="col">
                <a (click)="sortDocumentList($event, 'Id')">
                  <div class="d-flex">
                    <div>Id</div>
                    <div class="ml-3" *ngIf="docListSortOrderBy == 'Id'"><i class="fas fa-sort"></i></div>
                  </div>
                </a>
              </th>
              <th scope="col">
                <a (click)="sortDocumentList($event, 'Name')">
                  <div class="d-flex">
                    <div>Name</div>
                    <div class="ml-3" *ngIf="docListSortOrderBy == 'Name'"><i class="fas fa-sort"></i></div>
                  </div>
                </a>
              </th>
              <th scope="col">
                <a (click)="sortDocumentList($event, 'Date')">
                  <div class="d-flex">
                    <div>Date</div>
                    <div class="ml-3" *ngIf="docListSortOrderBy == 'Date'"><i class="fas fa-sort"></i></div>
                  </div>
                </a>
              </th>

            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of document_list">
              <th scope="row"> {{ item.id }} </th>
              <td> <a target="_blank" [href]="item.document_link" class=" font-weight-bold text-dark">{{ item.name }}</a> </td>
              <td>{{ item.created_date | date: 'mediumDate' }}</td>
            </tr>
          </tbody>
        </table>

        <div *ngIf="showDocumentEmptyIcon && !fetchingDocument" class=" d-flex flex-column justify-content-between align-items-center">
          <div><i class="fad fa-3x fa-files-medical"></i></div>
          <div class="mt-3 font-weight-bold">The user has no document</div>
        </div>

        <div *ngIf="fetchingDocument" class=" d-flex justify-content-center align-items-center">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden"></span>
          </div>
        </div>


      </div>
    </div>
  </div>





</div>
